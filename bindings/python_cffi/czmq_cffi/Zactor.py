################################################################################
#  THIS FILE IS 100% GENERATED BY ZPROJECT; DO NOT EDIT EXCEPT EXPERIMENTALLY  #
#  Read the zproject/README.md for information about making permanent changes. #
################################################################################
from .utils import *
from . import native
from . import destructors
libczmq = native.lib
libczmq_destructors = destructors.lib
ffi = native.ffi

class Zactor(object):
    """
    provides a simple actor framework
    """

    def __init__(self, task, args):
        """
        Create a new actor passing arbitrary arguments reference.
        """
        p = libczmq.zactor_new(self._p, task, args._p)
        if p == ffi.NULL:
            raise MemoryError("Could not allocate person")

        # ffi.gc returns a copy of the cdata object which will have the
        # destructor called when the Python object is GC'd:
        # https://cffi.readthedocs.org/en/latest/using.html#ffi-interface
        self._p = ffi.gc(p, libczmq_destructors.zactor_destroy_py)

    def send(self, msg_p):
        """
        Send a zmsg message to the actor, take ownership of the message
        and destroy when it has been sent.
        """
        return libczmq.zactor_send(self._p, msg_p._p)

    def recv(self):
        """
        Receive a zmsg message from the actor. Returns NULL if the actor
        was interrupted before the message could be received, or if there
        was a timeout on the actor.
        """
        return libczmq.zactor_recv(self._p)

    def is_py(self):
        """
        Probe the supplied object, and report if it looks like a zactor_t.
        """
        return libczmq.zactor_is(self._p)

    def resolve(self):
        """
        Probe the supplied reference. If it looks like a zactor_t instance,
        return the underlying libzmq actor handle; else if it looks like
        a libzmq actor handle, return the supplied value.
        """
        return libczmq.zactor_resolve(self._p)

    def sock(self):
        """
        Return the actor's zsock handle. Use this when you absolutely need
        to work with the zsock instance rather than the actor.
        """
        return libczmq.zactor_sock(self._p)

    def set_destructor(self, destructor):
        """
        Change default destructor by custom function. Actor MUST be able to handle new message instead of default $TERM.
        """
        return libczmq.zactor_set_destructor(self._p, destructor)

    def test(verbose):
        """
        Self test of this class.
        """
        return libczmq.zactor_test(verbose)

################################################################################
#  THIS FILE IS 100% GENERATED BY ZPROJECT; DO NOT EDIT EXCEPT EXPERIMENTALLY  #
#  Read the zproject/README.md for information about making permanent changes. #
################################################################################
