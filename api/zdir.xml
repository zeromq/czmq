<class name = "zdir">
    work with file-system directories

    <include filename = "../license.xml" />

    <constructor>
        Create a new directory item that loads in the full tree of the specified
        path, optionally located under some parent path. If parent is "-", then
        loads only the top-level directory, and does not use parent as a path.
        <argument name="path" type="string" />
        <argument name="parent" type="string" />
    </constructor>

    <destructor>
        Destroy a directory tree and all children it contains.
    </destructor>

    <method name="path">
        Return directory path
        <return type="string" />
    </method>

    <method name="modified">
        Return last modification time for directory.
        <return type="time" />
    </method>

    <method name="cursize">
        Return total hierarchy size, in bytes of data contained in all files
        in the directory tree.
        <return type="file_size" />
    </method>

    <method name="count">
        Return directory count
        <return type="size" />
    </method>

    <method name="list">
        Returns a sorted list of zfile objects; Each entry in the list is a pointer
        to a zfile_t item already allocated in the zdir tree. Do not destroy the
        original zdir tree until you are done with this list. The caller must destroy
        the list when done with it.
        <return type="zlist" fresh="1" />
    </method>

    <method name="remove">
        Remove directory, optionally including all files that it contains, at
        all levels. If force is false, will only remove the directory if empty.
        If force is true, will remove all files and all subdirectories.
        <argument name="force" type="boolean" />
    </method>

    <method name="diff" singleton="1">
        Calculate differences between two versions of a directory tree.
        Returns a list of zdir_patch_t patches. Either older or newer may
        be null, indicating the directory is empty/absent. If alias is set,
        generates virtual filename (minus path, plus alias).
        <argument name="older" type="zdir" />
        <argument name="newer" type="zdir" />
        <argument name="alias" type="string" />
        <return type="zlist" fresh="1" />
    </method>

    <method name="resync">
        Return full contents of directory as a zdir_patch list.
        <argument name="alias" type="string" />
        <return type="zlist" fresh="1" />
    </method>

    <method name="cache">
        Load directory cache; returns a hash table containing the SHA-1 digests
        of every file in the tree. The cache is saved between runs in .cache.
        The caller must destroy the hash table when done with it.
        <return type="zhash" fresh="1" />
    </method>

    <method name="fprint">
        Print contents of directory to open stream
        <argument name="file" type="FILE" />
        <argument name="indent" type="integer" />
    </method>

    <method name="print">
        Print contents of directory to stdout
        <argument name="indent" type="integer" />
    </method>
</class>
